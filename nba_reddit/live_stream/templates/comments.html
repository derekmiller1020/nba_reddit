{% extends "base.html" %}
{% block content %}

<style>
    #comment {
        border: 3px solid #ccc;
        height: 400px;
        overflow-y: auto;
        padding: 10px;
    }
    #responses {
        background-color: #b0c4de;
    }
</style>

<div class="row">
    <div class = "col-md-10 col-md-offset-2">
        <H1>Comments</H1><br>
    </div>
    <div class = "box_container">
        <div class="col-md-11 col-md-offset-3">
            <div id = "comment" class="box_container">

            </div>
        </div>
    </div>
</div>

{% if can_comment != "correct" %}
    <br><a href="{{link}}">Click here to comment or sign into Reddit</a><br>
{% elif can_comment = "correct" %}
    <textarea id = "woo"></textarea>
{% endif %}

<script type = "text/javascript">

(function poll(){
    $.ajax({
	    type : "POST",
		url : "/retrieve/",
        data: {
            'csrfmiddlewaretoken': '{{ csrf_token }}',
            'id': '{{threads}}'
        },
		error : function () {
			console.log("if you can see this, Let someone know that there was an error");
		},
		success : function(data) {
            var something = data.reverse();
            var si = [];
            for (var i=0; i<something.length; i++){
                var responses = something[i];
                si.push("<br><b>" + responses["author"] + ":</b><br><div id='responses'>"
                    + responses["body"] + "</div><br>" );
            }
            $("#comment").html(si);
		},
		complete: poll,
		timeout: 30000
	});
})();


</script>
{% endblock %}